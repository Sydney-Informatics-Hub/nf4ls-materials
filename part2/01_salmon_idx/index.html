
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../00_intro/">
      
      
        <link rel="next" href="../02_fastqc/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>2.1 Our first process and container - Nextflow for the Life Sciences</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-TNWWV3HK57"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-TNWWV3HK57",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-TNWWV3HK57",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#21-implementing-a-simple-process-with-a-container" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nextflow for the Life Sciences" class="md-header__button md-logo" aria-label="Nextflow for the Life Sciences" data-md-component="logo">
      
  <img src="../../assets/usyd-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nextflow for the Life Sciences
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2.1 Our first process and container
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Sydney-Informatics-Hub/hello-nextflow-2025" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Sydney-Informatics-Hub/hello-nextflow-2025
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nextflow for the Life Sciences" class="md-nav__button md-logo" aria-label="Nextflow for the Life Sciences" data-md-component="logo">
      
  <img src="../../assets/usyd-logo.png" alt="logo">

    </a>
    Nextflow for the Life Sciences
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Sydney-Informatics-Hub/hello-nextflow-2025" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Sydney-Informatics-Hub/hello-nextflow-2025
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Part 1
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Part 1
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/00_whynextflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.0 Why Nextflow?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/01_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.1 Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/02_helloworld/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.2 Hello World!
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/03_hellonf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.3 Writing your first pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/04_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.4 Running pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/05_inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.5 Inputs and channels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/06_params/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.6 Parameters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/07_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.7 Adding processes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/08_dynamic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.8 Dynamic naming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/09_outro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1.9 Wrapping up
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Part 2
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Part 2
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.0 Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    2.1 Our first process and container
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    2.1 Our first process and container
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#211-building-the-index-process" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.1 Building the INDEX process
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#212-saving-our-output-files-to-an-output-directory-with-publishdir" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.2 Saving our output files to an output directory with publishDir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#213-adding-params-and-the-workflow-scope" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.3 Adding params and the workflow scope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#214-using-containers-for-reproducible-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.4 Using containers for reproducible pipelines
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#215-running-the-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.5 Running the workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#216-inspecting-the-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.6 Inspecting the outputs
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_fastqc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.2 Samplesheets, operators, and groovy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_quant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.3 Multiple process inputs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_multiqc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.4 Combining channels, multiple process outputs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_scale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2.5 Upscaling to multiple samples and introspection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Supporting materials
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#211-building-the-index-process" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.1 Building the INDEX process
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#212-saving-our-output-files-to-an-output-directory-with-publishdir" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.2 Saving our output files to an output directory with publishDir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#213-adding-params-and-the-workflow-scope" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.3 Adding params and the workflow scope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#214-using-containers-for-reproducible-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.4 Using containers for reproducible pipelines
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#215-running-the-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.5 Running the workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#216-inspecting-the-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1.6 Inspecting the outputs
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="21-implementing-a-simple-process-with-a-container">2.1 Implementing a simple process with a container</h1>
<div class="admonition info">
<p class="admonition-title">Learning objectives</p>
<ol>
<li>Implement a Nextflow process that takes a single file as input.  </li>
<li>Understand the importance of containers in ensuring consistent and
reproducible execution across processes.</li>
<li>Apply the <code>publishDir</code> directive to store process outputs in a specified directory. </li>
</ol>
</div>
<p>In this lesson we will be implement <code>00_index.sh</code> as our first Nextflow process, <code>INDEX</code>. Here, we are working with the first step of the RNAseq data processing workflow: indexing the transcriptome for downstream processes. To do this, we will need to run <a href="https://salmon.readthedocs.io/en/latest/salmon.html#salmon">Salmon</a>'s indexing mode. 
<br>
<br>
<br>
<img alt="" src="../img/2.1_workflow.png" />
<br>
<br>
Open the bash script <code>00_index.sh</code>:  </p>
<div class="highlight"><span class="filename">00_index.sh</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>mkdir<span class="w"> </span><span class="s2">&quot;results&quot;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>salmon<span class="w"> </span>index<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span>--transcripts<span class="w"> </span>data/ggal/transcriptome.fa<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span>--index<span class="w"> </span>results/salmon_index
</code></pre></div>
<ul>
<li>The script first creates a <code>results/</code> folder then runs the <code>salmon index</code> command.  </li>
<li>The Salmon <code>--transcripts</code> flag indicates that the path to the input transcriptome
file is <code>data/ggal/transcriptome.fa</code>.  </li>
<li>The Salmon <code>--index results/salmon_index</code> flag tells <code>salmon</code> to save the output index files in a directory called <code>salmon_index</code>, within the newly created <code>results</code> directory.  </li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Avoid hardcoding arguments by using parameters</p>
<p>The paths to the transcriptome file (<code>data/ggal/transcriptome.fa</code>) and the output directory (<code>results/salmon_index</code>) are hardcoded in this bash script. If you wanted to change the input transcriptome file or the output location, you must manually edit the script. This makes our scripts less flexible and easy to use. </p>
<p>As we will see, Nextflow addresses the issue of hardcoded paths by allowing values to be passed dynamically at runtime as <a href="https://www.nextflow.io/docs/latest/config.html#parameters">parameters</a> (<code>params</code>). </p>
</div>
<h2 id="211-building-the-index-process">2.1.1 Building the <code>INDEX</code> process</h2>
<p>In the empty <code>main.nf</code> script, add the following <code>process</code> scaffold with the
script definition:  </p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">process</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="nl">input:</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="o">&lt;</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="o">&gt;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="nl">output:</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="o">&lt;</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="o">&gt;</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="nl">script:</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="s2">  salmon index --transcripts $transcriptome --index salmon_index</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="s2">  &quot;&quot;&quot;</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="o">}</span>
</code></pre></div>
<p>It contains: </p>
<ul>
<li>The empty <code>input:</code> block for us to define the input data for the process. </li>
<li>The empty <code>output:</code> block for us to define the output data for the process.</li>
<li>The <code>script:</code> block prefilled with the command that will be executed.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The process <a href="https://www.nextflow.io/docs/latest/process.html#script"><code>script</code></a>
block is executed as a Bash script by default. In Part 2 of the workshop, we will
only be using Nextflow variables within the <code>script</code> block.</p>
</div>
<p>Note how we have modified the original bash script in two ways.</p>
<p>First, we have replaced the hard-coded path to the transcriptome file with a Nextflow variable: <code>$transcriptome</code>. This will allow us to use this process to index any transcriptome FASTA file we want without having to modify the command itself.</p>
<p>Second, we removed the creation of a <code>results</code> directory and simply told Salmon to create the new index <code>salmon_index</code> within the current directory. The original script created a <code>results</code> directory as a way to organise its outputs neatly, but we don't need to worry about being so neat here; instead, as you will see below, we will use the <code>publishDir</code> to neatly organise our outputs.</p>
<p>Next, we will edit the <code>input</code> and <code>output</code> blocks to match the expected
data and results for this process. Looking back at our original bash script <code>00_index.sh</code>, we can see that:  </p>
<ul>
<li>Our input is a FASTA (<code>.fa</code>) file, now represented by the variable <code>$transcriptome</code> and provided
to the <code>--transcripts</code> flag  </li>
<li>The name of the index output directory, defined by using the <code>--index</code> flag, is called <code>salmon_index/</code>  </li>
</ul>
<div class="admonition info">
<p class="admonition-title">Defining inputs and outputs</p>
<p>Remember, input and output definitions require a qualifier and name. For example:<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nl">input:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&lt;</span><span class="n">input</span><span class="w"> </span><span class="n">qualifier</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">input</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nl">output:</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">&lt;</span><span class="n">output</span><span class="w"> </span><span class="n">qualifier</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">output</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;</span>
</code></pre></div></p>
<p>The qualifier defines the type of data, and the names are treated like variables.</p>
</div>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">process</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="o">[</span><span class="w"> </span><span class="n">directives</span><span class="w"> </span><span class="o">]</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="nl">input:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="hll"><span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">transcriptome</span>
</span><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="nl">output:</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="hll"><span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;salmon_index&#39;</span>
</span><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span><span class="nl">script:</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="s2">  salmon index --transcripts $transcriptome --index salmon_index</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="s2">  &quot;&quot;&quot;</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="o">}</span>
</code></pre></div>
<p>Note that the input <code>path transcriptome</code> refers to a variable, meaning the
actual file or directory provided as input can be changed depending on the data
you provide it. The output <code>path 'salmon_index'</code> is fixed, meaning it will
always expect an output folder called <code>salmon_index</code>, no matter what the input
is.  </p>
<p>This is how Nextflow can handle different inputs while always producing the
same output name.  </p>
<p>More information on using input and output blocks can be found in the Nextflow documentation for process
<a href="https://www.nextflow.io/docs/latest/process.html#inputs">inputs</a> and
<a href="https://www.nextflow.io/docs/latest/process.html#outputs">outputs</a>.  </p>
<h2 id="212-saving-our-output-files-to-an-output-directory-with-publishdir">2.1.2 Saving our output files to an output directory with <code>publishDir</code></h2>
<p>Next we will implement the Nextflow equivalent of saving the output files into a
<code>results/</code> directory. Recall from <a href="../../part1/04_execution/#publishing-outputs">Part 1</a> 
that we can use the <code>publishDir</code> directive to accomplish this. This will direct Nextflow
to copy all of the process' outputs to a given directory.</p>
<p>We can also specify <em>how</em> Nextflow will copy our results to the <code>publishDir</code> directory by
setting the <code>mode</code>. We can tell Nextflow to make a complete copy of the outputs by setting the
<code>mode</code> to <code>"copy"</code>, e.g.:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">publishDir</span><span class="w"> </span><span class="s2">&quot;results&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">mode:</span><span class="w"> </span><span class="s1">&#39;copy&#39;</span>
</code></pre></div>
<details class="example">
<summary>Advanced content: <code>publishDir</code> modes</summary>
<p>The <code>publishDir</code> directive has several modes that change how it behaves.
By default, Nextflow will create a <strong>symbolic link</strong> in the publishing directory.
This is a special type of file that points to another file, similar to a shortcut.
The advantage of using a symbolic link is that it doesn't require
duplicating the output files, meaning it uses less space and is quick to make.
The disadvantage, however, is that the actual data is still stored in the <code>work/</code> directory.
If you ever clean up the <code>work/</code> directory, you will break the symbolic links and you will lose
your data.</p>
<p>We will be using the <code>"copy"</code> mode for the remainder of this workshop, which tells Nextflow
to make a complete copy of the data within the publishing directory, thereby ensuring that the
final outputs of the pipeline are always available there.</p>
<p>The other modes that are available are described in detail in the <a href="https://www.nextflow.io/docs/latest/reference/process.html#publishdir">Nextflow documentation</a>.</p>
</details>
<p>Replace the <code>[ directives ]</code> placeholder in your <code>main.nf</code> script with the <code>publishDir</code> 
directive, specifying the directory name as <code>"results"</code> and the mode as
<code>'copy'</code>. Your <code>main.nf</code> should look like this: </p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">process</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="hll"><span class="w">  </span><span class="n">publishDir</span><span class="w"> </span><span class="s2">&quot;results&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">mode:</span><span class="w"> </span><span class="s1">&#39;copy&#39;</span>
</span><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nl">input:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="n">transcriptome</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="nl">output:</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;salmon_index&#39;</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="nl">script:</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">  </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="s2">  salmon index --transcripts $transcriptome --index salmon_index</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="s2">  &quot;&quot;&quot;</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="o">}</span>
</code></pre></div>
<p>This process is now directed to copy all output files (i.e. the <code>salmon_index</code> directory) into a <code>results/</code>
directory. This saves having to specify the output directory in the script
definition each process, or a tedious <code>mv salmon_index/ results/</code> step. </p>
<p>Nextflow also handles whether the directory already exists or if it
should be created. In the <code>00_index.sh</code> script you had to manually make a 
results directory with <code>mkdir -p "results</code>.</p>
<p>More information and other modes can be found on
<a href="https://www.nextflow.io/docs/latest/reference/process.html#publishdir">publishDir</a>.</p>
<h2 id="213-adding-params-and-the-workflow-scope">2.1.3 Adding <code>params</code> and the workflow scope</h2>
<p>Now that you have written your first Nextflow process, we need to prepare it
for execution.  </p>
<p>You can think of Nextflow processes as similar to a function definition in R
or Python. We have defined what the process should do, but to actually run it,
we need to call the process within the workflow and pass in the inputs.</p>
<p>To run the process, we need to call it inside the <code>workflow{}</code> block, where
we control how data flows through the pipeline. To provide the input data we
need to define parameters. </p>
<p>In the <code>00_index.sh</code> script, the file <code>data/ggal/transcriptome.fa</code> was passed
as the input into <code>salmon index</code>.  </p>
<p>We will pass in this file path with the <code>params</code> scope. Add the following to 
the top of your <code>main.nf</code> script:  </p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">// pipeline input parameters</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;$projectDir/data/ggal/transcriptome.fa&quot;</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Implicit variables in Nextflow</p>
<p>Nextflow provides a set of implicit variables that can be used in your workflows. These variables are predefined and can be used to access information about the workflow environment, configuration, and tasks. </p>
<p>We will use <a href="https://www.nextflow.io/docs/latest/config.html#constants"><code>$projectDir</code></a> to indicate the directory of the <code>main.nf</code> script. This is defined by Nextflow as the directory where the <code>main.nf</code> script is located.</p>
</div>
<div class="admonition info">
<p class="admonition-title">The <code>params</code> and <code>process</code> names do not need to match!</p>
<p>In the <code>INDEX</code> process, we defined the input as a path called <code>transcriptome</code>, whereas
the parameter is called <code>transcriptome_file</code>. These do not need to be identical names
as they are called in different scopes (the <code>INDEX</code> process scope, and <code>workflow</code> scope,
respectively).</p>
</div>
<p>Recall that <a href="https://www.nextflow.io/docs/latest/module.html#module-parameters">parameters</a>
are inputs and options that can be customised when the workflow is 
executed. They allow you to control things like file paths and options for 
tools without changing the process code itself.  </p>
<p>We defined a default value for <code>params.transcriptome_file</code> in the <code>main.nf</code> script. 
If we need to run our pipeline with a different transcriptome 
file, we can overwrite this default in our execution command with 
<code>--transcriptome_file</code> double hyphen flag.</p>
<p>Next, add the workflow scope at the bottom of your <code>main.nf</code> after the process:  </p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">// Define the workflow</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">workflow</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="c1">// Run the index step with the transcriptome parameter</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="n">INDEX</span><span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">transcriptome_file</span><span class="o">)</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="o">}</span>
</code></pre></div>
<p>This will tell Nextflow to run the <code>INDEX</code> process with
<code>params.transcriptome_file</code> as input.</p>
<div class="admonition tip">
<p class="admonition-title">Tip: Your own comments</p>
<p>As a developer you can to choose how and where to comment your code!
Feel free to modify or add to the provided comments to record useful
information about the code you are writing.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Exercise</p>
<p>Now that we have a complete process and workflow, we should be able to run it!</p>
<p>In your VSCode terminal, ensure you are inside the <code>part2/</code> directory, then run the following:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>nextflow<span class="w"> </span>run<span class="w"> </span>main.nf
</code></pre></div>
<p>What happened? Did the pipeline run successfully? If not, why not?</p>
<details class="solution">
<summary>Solution</summary>
<p>Something went wrong! The pipeline didn't successfully run!</p>
<p>You should have received an error message similar to the following:</p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="go"> N E X T F L O W   ~  version 24.10.2</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="go">Launching `main.nf` [peaceful_neumann] DSL2 - revision: caa2043bdf</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="go">executor &gt;  local (1)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="go">executor &gt;  local (1)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="go">[eb/ec6173] process &gt; INDEX [100%] 1 of 1, failed: 1 âœ˜</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="go">ERROR ~ Error executing process &gt; &#39;INDEX&#39;</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="go">Caused by:</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="go">Process `INDEX` terminated with an error exit status (127)</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="go">Command executed:</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="go">salmon index --transcripts transcriptome.fa --index salmon_index</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="go">Command exit status:</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="go">127</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="go">Command output:</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="gp gp-VirtualEnv">(empty)</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="go">Command error:</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="hll"><span class="go">.command.sh: line 2: salmon: command not found</span>
</span><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="go">Work dir:</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="go">/home/training/_part2/work/eb/ec617307600cd47fc5b65d1c60269e</span>
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="go">Tip: you can try to figure out what&#39;s wrong by changing to the process work dir and showing the script file named `.command.sh`</span>
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="go">-- Check &#39;.nextflow.log&#39; file for details</span>
</code></pre></div>
<p>Nextflow's error message tells us exactly why this failed. The highlighted line above tells us that the <code>salmon</code> command couldn't be found.</p>
<p>Why did this happen? Because we don't have <code>salmon</code> installed!</p>
<p>How do we fix this? We'll explore that in the very next section...</p>
</details>
</div>
<h2 id="214-using-containers-for-reproducible-pipelines">2.1.4 Using containers for reproducible pipelines</h2>
<p>One of the primary goals of workflow managers like Nextflow is to improve the portability
of a pipeline. Ideally, we could take our pipeline to any computer and it would run with
minimal setup - in short, "write once, run anywere".</p>
<p>However, all but the most trivial workflows will require specialised software that
can't be assumed to be installed on any given computer. To ensure that the pipeline
requires "minimal setup", we can't be asking the end users to install every piece of software
the pipeline requires. So how can we ensure that the end user can run our pipeline
without needing to install all of its dependencies?</p>
<p>The answer is <strong>containers</strong>.</p>
<p>Containers package all the software and dependencies needed
for each tool into a self-contained environment. This means you donâ€™t have to
manually install anything on your system, and your workflow will work
consistently across different systems â€” whether you're running it on your
local machine, a cluster, or in the cloud. Containers make it easier to share
your workflow with others and ensure it runs the same way every time, no matter
where it's executed.</p>
<p>Nextflow recommends as a <strong>best practice</strong> to use containers to ensure the
reproducibility and portability of your workflows.</p>
<p>Nextflow supports
<a href="https://www.nextflow.io/docs/latest/container.html#">multiple container runtimes</a>.
In this workshop, we'll be demonstrating the value containers can bring to your
workflow by using Singularity.</p>
<details class="tip">
<summary>Tip: different tools for different purposes</summary>
<p>In this workshop, we're using Singularity to run containers. You may have heard of another container technology before: Docker.
Both Singularity and Docker work in similar ways to encapuslate tools within an environment to ensure reproducibility.
However, Docker has certain administrative access requirements that make it unsuitable for some
systems like HPCs. For this reason, we will be working with Singularity.</p>
<p>You don't have to write your own containers to run in your workflow. There are
many container repositories out there. We highly recommend using 
<a href="https://biocontainers.pro/registry">Biocontainers</a> wherever possible.
Biocontainers are pre-built and tested containers specifically for
bioinformatics tools. They have a huge library and great community support. </p>
<p>You can find Biocontainers at the following repositories:  </p>
<ul>
<li><a href="https://biocontainers.pro/registry">Biocontainers registry</a></li>
<li><a href="https://quay.io/organization/biocontainers">Quay.io</a></li>
<li><a href="https://hub.docker.com/r/biocontainers/biocontainers">DockerHub</a></li>
<li><a href="https://seqera.io/containers/">Seqera containers</a></li>
</ul>
<p>Another helpful fact is that Docker containers are often able to be converted to Singularity's format, meaning if a tool
is only available as a Docker image, it is highly likely that it can still be used with Singularity.</p>
</details>
<p>In Nextflow, we can specify that a process should be run within a specified container using the <a href="https://www.nextflow.io/docs/latest/process.html#container">container</a> directive.  </p>
<p>Add the following container directive to the <code>INDEX</code> process, above <code>publishDir</code>:  </p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">process</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="hll"><span class="w">    </span><span class="n">container</span><span class="w"> </span><span class="s2">&quot;quay.io/biocontainers/salmon:1.10.1--h7e5ed60_0&quot;</span>
</span><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="n">publishDir</span><span class="w"> </span><span class="s2">&quot;results&quot;</span><span class="o">,</span><span class="w"> </span><span class="nl">mode:</span><span class="w"> </span><span class="s1">&#39;copy&#39;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="nl">input:</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="n">transcriptome</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="nl">output:</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="s1">&#39;salmon_index&#39;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="nl">script:</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="s2">    salmon index --transcripts $transcriptome --index salmon_index</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="o">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Usually, containers need to be downloaded using a command such as
<code>singularity pull [image]</code>. All containers have been previously downloaded for the
workshop beforehand.</p>
</div>
<details class="tip">
<summary>Tip: use one container per process</summary>
<p>Using single containers for each process in your workflow is considered best practices for the following reasons:</p>
<ul>
<li><strong>Flexibility</strong>: different processes require different tools (or versions). By using separate containers, you can easily tailor the container to the needs of each process without conflicts.</li>
<li><strong>Build and run efficiency</strong>: Smaller, process-specific containers are faster to load and run compared to one large container that has unnecessary tools or dependencies for every process.</li>
<li><strong>Easier Maintenance</strong>: itâ€™s easier to update or modify one container for a specific process than to manage a large, complex container with many tools.</li>
<li><strong>Reproducibility</strong>: reduces the risk of issues caused by software conflicts.</li>
</ul>
</details>
<p>Now our process has a container associated with it, but before we can run the workflow,
we need to tell Nextflow <strong>how</strong> to run the container. Specifically, we need to specify that
we want to run containers using Singularity. Note that this also requires Singularity
to be installed on your system in order for this to work. Singularity has been 
pre-installed on your Virtual Machine. See the <a href="https://www.nextflow.io/docs/latest/container.html#singularity">Nextflow documentation</a>
for further details on running workflows with Singularity.</p>
<p>We can configure Nextflow to run containers with Singularity by using the 
<code>nextflow.config</code> file.</p>
<p>Create a <code>nextflow.config</code> file in the same directory as <code>main.nf</code>.  </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can create the file via the VSCode Explorer (left sidebar) or in the
terminal with a text editor.</p>
<p>If you are using the Explorer, right click on <code>part2</code> in the sidebar and
select <strong>"New file"</strong>.</p>
</div>
<p>Add the following lines to your config file:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">nextflow.config</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">singularity</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">    </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="n">cacheDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;$HOME/singularity_image&quot;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="o">}</span>
</code></pre></div></td></tr></table></div>
<p>The syntax <code>singularity { }</code> defines the configuration for using Singularity; everything between the curly braces here will tell Nextflow how to use Singularity to run your workflow.</p>
<p>The first line, <code>enabled = true</code> simply tells Nextflow to use Singularity. The second line, <code>cacheDir = $HOME/singularity_image</code> tells Nextflow to store images in a folder within your home directory called <code>singularity_image</code>. This means that Nextflow only has to pull a given image from the internet once; every other time it requires that image, it can quickly load it from this cache directory.</p>
<p>You have now configured Nextflow to run your process within a Singularity container! In this case, the <code>INDEX</code> process will use the <code>quay.io/biocontainers/salmon:1.10.1--h7e5ed60_0</code> container. As we add more processes, wherever we define the <code>container</code> directive, Nextflow will use that container to run that process.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Remember to save your files after editing them!</p>
</div>
<p>We now have a complete process and workflow, along with directives and configuration for using containers. We are ready to try running our workflow again!</p>
<h2 id="215-running-the-workflow">2.1.5 Running the workflow</h2>
<p>In the terminal, run the command:  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>nextflow<span class="w"> </span>run<span class="w"> </span>main.nf
</code></pre></div>
<p>Your output should look something like:  </p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="go">N E X T F L O W   ~  version 24.10.2</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="go">Launching `main.nf` [chaotic_jones] DSL2 - revision: 6597720332</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="go">executor &gt;  local (1)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="go">[de/fef8c4] INDEX | 1 of 1 âœ”</span>
</code></pre></div>
<p>Recall that the specifics of the output are randomly generated (i.e.
<code>[chaotic_jones]</code> and <code>[de/fef8c4]</code> in this example).</p>
<p>In this example, the output files for the <code>INDEX</code> process is output in
<code>work/de/fef8c4...</code>.</p>
<p>You have successfully run your first workflow!  </p>
<h2 id="216-inspecting-the-outputs">2.1.6 Inspecting the outputs</h2>
<p>You will notice that we have two new folders in our working directory: <code>results/</code> and <code>work/</code>.</p>
<p>First, let's look at the <code>results/</code> directory. It should contain a single subdirectory: <code>salmon_index/</code>. Inside are all the files that make up the <code>salmon</code> reference index used for quantifying reads.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ls<span class="w"> </span>results
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="go">salmon_index</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>ls<span class="w"> </span>results/salmon_index
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="go">complete_ref_lens.bin   mphf.bin             ref_indexing.log</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="go">ctable.bin              pos.bin              reflengths.bin</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="go">ctg_offsets.bin         pre_indexing.log     refseq.bin</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="go">duplicate_clusters.tsv  rank.bin             seq.bin</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="go">info.json               refAccumLengths.bin  versionInfo.json</span>
</code></pre></div>
<p>This is the exact same directory structure that our original <code>00_index.sh</code> script was creating when running <code>mkdir "results"</code> and passing the <code>--index results/salmon_index</code> parameter to <code>salmon</code>.
But now, Nextflow is handling this for us thanks to the <code>publishDir</code> directive we gave to the <code>INDEX</code> process.
That directive told Nextflow to create the <code>results/</code> directory (if it didn't already exist) and copy the <code>salmon_index</code> output into it.</p>
<p>The other directory that has been created is <code>work/</code>. This is where Nextflow runs all of our processes and stores all of their associated files.
Understanding how the <code>work/</code> directory is organised can be very useful for debugging and diagnosing problems with your processes.</p>
<p>You may recall from <a href="../../part1/03_hellonf/">Part 1.3</a>, every time a process is run, it is given a randomly-generated ID, such as <code>ec/9ed7c7d13ca353bbd8e99835de8c47</code>.
This helps Nextflow uniquely identify each instance of every process. You will see a truncated form of this ID printed to the terminal when running Nextflow:</p>
<div class="highlight"><span class="filename">Nextflow output</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="go">    N E X T F L O W   ~  version 24.10.2</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="go">Launching `main.nf` [sleepy_volhard] DSL2 - revision: c2ada21e4e</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="go">executor &gt;  local (1)</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="go">[ec/9ed7c7] process &gt; INDEX [100%] 1 of 1 âœ”</span>
</code></pre></div>
<p>Nextflow creates a directory inside <code>work/</code> with this same path for each instance of every process. Inside will be the output of that process as well as copies of its inputs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>ls<span class="w"> </span>work/ec/9ed7c7d13ca353bbd8e99835de8c47<span class="w">  </span><span class="c1"># Your work directory will have a different name</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="go">salmon_index  transcriptome.fa</span>
</code></pre></div>
<p>There will also be several hidden files that Nextflow uses to run and monitor the process:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>ls<span class="w"> </span>-A<span class="w"> </span>work/ec/9ed7c7d13ca353bbd8e99835de8c47<span class="w">  </span><span class="c1"># Your work directory will have a different name</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="go">.command.begin  .command.out  .exitcode</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="go">.command.err    .command.run  salmon_index</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="go">.command.log    .command.sh   transcriptome.fa</span>
</code></pre></div>
<p>Of particular interest to us right now is the <code>.command.sh</code> file, which contains our process script.</p>
<div class="admonition question">
<p class="admonition-title">Exercises</p>
<p><ol>
    <li>Navigate to the <code>work/</code> directory and open the <code>.command.sh</code> file.</li>
    <li>Compare the <code>.command.sh</code> file with our <code>INDEX</code> process. How do they differ? How are they similar?</li>
</ol></p>
<details class="solution">
<summary>Solution</summary>
<p>The command in <code>.command.sh</code> should look very similar to the script block in the <code>INDEX</code> process,
except now the Nextflow variable <code>$transcriptome</code> has been replaced by a relative path to the
<code>transcriptome.fa</code> file present in the working directory:</p>
<div class="highlight"><span class="filename">main.nf</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">process</span><span class="w"> </span><span class="n">INDEX</span><span class="w"> </span><span class="o">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="o">...</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="nl">script:</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="s2">    salmon index -t $transcriptome -i salmon_index</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="o">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">.command.sh</span><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="ch">#!/bin/bash -ue</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>salmon<span class="w"> </span>index<span class="w"> </span>-t<span class="w"> </span>transcriptome.fa<span class="w"> </span>-i<span class="w"> </span>salmon_index
</code></pre></div>
</details>
<p><ol start="3">
    <li>How does <code>.command.sh</code> compare to the original <code>00_index.sh</code> script?</li>
</ol></p>
<details class="solution">
<summary>Solution</summary>
<p>The <code>.command.sh</code> script contains a hard-coded path to the copy of the <code>transcriptome.fa</code> file within the task directory, which closely resembles our hard-coded <code>salmon</code> command in our original <code>00_index.sh</code> script:</p>
<div class="highlight"><span class="filename">00_index.sh</span><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>salmon<span class="w"> </span>index<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span>--transcripts<span class="w"> </span>data/ggal/transcriptome.fa<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span>--index<span class="w"> </span>results/salmon_index
</code></pre></div>
<div class="highlight"><span class="filename">.command.sh</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="ch">#!/bin/bash -ue</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>salmon<span class="w"> </span>index<span class="w"> </span>-t<span class="w"> </span>transcriptome.fa<span class="w"> </span>-i<span class="w"> </span>salmon_index
</code></pre></div>
<p>In a sense, Nextflow is doing the same thing we would have had to do with our original set of bash scripts: make a copy, modify the hard-coded values, and run them.
Except now, it is all being automated and handled for us by Nextflow!</p>
</details>
</div>
<details class="example">
<summary>Advanced content: the <code>work/</code> directory hidden files</summary>
<p>The other hidden files inside the work directory have the following roles:</p>
<ul>
<li><code>.command.run</code>: A "wrapper script" that contains all the behind-the-scenes logic to run and monitor <code>.command.sh</code>.</li>
<li><code>.command.out</code>: The standard output log from <code>.command.sh</code>.</li>
<li><code>.command.err</code>: The standard error log from <code>.command.sh</code>.</li>
<li><code>.command.log</code>: The output log generated by the <code>.command.run</code> wrapper script.</li>
<li><code>.command.begin</code>: A file created as soon as the job is launched.</li>
<li><code>.exitcode</code>: A file created at the end of the job containing the task exit code (0 if successful)</li>
</ul>
</details>
<div class="admonition abstract">
<p class="admonition-title">Summary</p>
<p>In this lesson you have learned:  </p>
<ol>
<li>How to implement a simple process with one input file  </li>
<li>How to define parameters in your workflow scripts and the command line</li>
<li>How to use configure a process to run using a container   </li>
<li>How to output files in a dedicated <code>publishDir</code>  </li>
</ol>
</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../00_intro/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 2.0 Introduction">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                2.0 Introduction
              </div>
            </div>
          </a>
        
        
          
          <a href="../02_fastqc/" class="md-footer__link md-footer__link--next" aria-label="Next: 2.2 Samplesheets, operators, and groovy">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                2.2 Samplesheets, operators, and groovy
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.footer", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>